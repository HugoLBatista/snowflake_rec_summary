CREATE TABLE IF NOT EXISTS m_session_recommendation_summary (
	account_id int not null,	
	session_date date not null,
	new_customers int null,
	page_views int null,
	product_views int null,
	impressions int null,
	SESSION_HASRECCLICKED_HASRECCONVERTED_HASRECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_HASRECCLICKED_HASRECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_HASRECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,		
	SESSION_HASRECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_NOPURCHASE int null,
	SESSION_NORECCLICKED_HASRECCONVERTED_NORECCLIKEDCONVERTED_HASPURCHASE int null,	
	SESSION_NORECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_NORECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_NOPURCHASE int null,
	SESSION_REVENUE_HASRECCLICKED_HASRECCONVERTED_HASRECCLICKCONVERTED_HASPURCHASE float null,	
	SESSION_REVENUE_HASRECCLICKED_HASRECCONVERTED_NORECCLICKCONVERTED_HASPURCHASE float null,	
	SESSION_REVENUE_HASRECCLICKED_NORECCONVERTED_NORECCLICKCONVERTED_HASPURCHASE float null,
	SESSION_REVENUE_NORECCLICKED_HASRECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE float null,
	SESSION_REVENUE_NORECCLICKED_NORECCONVERTED_NORECCLICKCONVERTED_HASPURCHASE float null,
	SESSION_TRANSACTION_COUNT_HASRECCLICKED_HASRECCONVERTED_HASRECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_TRANSACTION_COUNT_HASRECCLICKED_HASRECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_TRANSACTION_COUNT_HASRECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_TRANSACTION_COUNT_NORECCLICKED_HASRECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_TRANSACTION_COUNT_NORECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_ITEM_COUNT_HASRECCLICKED_HASRECCONVERTED_HASRECCLICKEDCONVERTED_HASPURCHASE int null,
        SESSION_ITEM_COUNT_HASRECCLICKED_HASRECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_ITEM_COUNT_HASRECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,	
	SESSION_ITEM_COUNT_NORECCLICKED_HASRECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_ITEM_COUNT_NORECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	ITEM_REVENUE_HASRECCLICKED_HASRECCONVERTED_HASRECCLICKEDCONVERTED_HASPURCHASE float null,	
	ITEM_COUNT_HASRECCLICKED_HASRECCONVERTED_HASRECCLICKEDCONVERTED_HASPURCHASE int null
	

	PRIMARY KEY (session_date, account_id)
        ) cluster by (session_date, account_id);
	
	
	
	CREATE TABLE IF NOT EXISTS m_session_recommendation_action_summary (
	account_id int not null,	
	session_date date not null,
	action_id int null,
	impressions int null,	
	clickthroughs int null,	
	SESSION_HASRECCLICKED_HASRECCONVERTED_HASRECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_HASRECCLICKED_HASRECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_HASRECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,		
	SESSION_HASRECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_NOPURCHASE int null,
	SESSION_NORECCLICKED_HASRECCONVERTED_NORECCLIKEDCONVERTED_HASPURCHASE int null,	
	SESSION_NORECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_NORECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_NOPURCHASE int null,
	SESSION_REVENUE_HASRECCLICKED_HASRECCONVERTED_HASRECCLICKCONVERTED_HASPURCHASE float null,	
	SESSION_REVENUE_HASRECCLICKED_HASRECCONVERTED_NORECCLICKCONVERTED_HASPURCHASE float null,	
	SESSION_REVENUE_HASRECCLICKED_NORECCONVERTED_NORECCLICKCONVERTED_HASPURCHASE float null,
	SESSION_REVENUE_NORECCLICKED_HASRECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE float null,
	SESSION_REVENUE_NORECCLICKED_NORECCONVERTED_NORECCLICKCONVERTED_HASPURCHASE float null,
	SESSION_TRANSACTION_COUNT_HASRECCLICKED_HASRECCONVERTED_HASRECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_TRANSACTION_COUNT_HASRECCLICKED_HASRECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_TRANSACTION_COUNT_HASRECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_TRANSACTION_COUNT_NORECCLICKED_HASRECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_TRANSACTION_COUNT_NORECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_ITEM_COUNT_HASRECCLICKED_HASRECCONVERTED_HASRECCLICKEDCONVERTED_HASPURCHASE int null,
        SESSION_ITEM_COUNT_HASRECCLICKED_HASRECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_ITEM_COUNT_HASRECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,	
	SESSION_ITEM_COUNT_NORECCLICKED_HASRECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	SESSION_ITEM_COUNT_NORECCLICKED_NORECCONVERTED_NORECCLICKEDCONVERTED_HASPURCHASE int null,
	ITEM_REVENUE_HASRECCLICKED_HASRECCONVERTED_HASRECCLICKEDCONVERTED_HASPURCHASE float null,	
	ITEM_COUNT_HASRECCLICKED_HASRECCONVERTED_HASRECCLICKEDCONVERTED_HASPURCHASE int null

	PRIMARY KEY (session_date, account_id)
        ) cluster by (session_date, account_id);
	
